<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LISA App - Terms & Download</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>LISA App - Terms & Download</h1>

        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <ul class="flash-messages">
            {% for category, message in messages %}
              <li class="{{ category or 'message' }}">{{ message }}</li>
            {% endfor %}
            </ul>
          {% endif %}
        {% endwith %}

        <div class="terms">
            <p><strong>Using This App (LISA - Live Intelligent Sight Assistance):</strong></p>
            <p>Thanks for showing interest in LISA! This version is just for you to test and evaluate for **personal, non-commercial use only.**</p>
            <p>By downloading, please agree to these simple conditions:</p>
            <ul>
                <li>**Keep it to yourself:** Please don't share, sell, or redistribute this app file to anyone else.</li>
                <li>**No business use:** This app isn't intended for commercial activities or making money.</li>
                <li>**Leave the code as is:** Please don't try to modify, reverse engineer, take apart, or copy the app's code.</li>
                </ul>
            <p>Copyright Â© 2025 Sri Vidhya Putala. All rights reserved.</p>
        </div>

        <form id="agreementForm" action="{{ url_for('submit_agreement') }}" method="POST">
            <label for="nameInput">Name:</label>
            <input type="text" id="nameInput" name="user_name" required>

            <label for="emailInput">Email:</label>
            <input type="email" id="emailInput" name="user_email" required>

            <div class="checkbox-container">
                <input type="checkbox" id="agreeCheckbox" name="agree_terms" value="yes" required>
                <label for="agreeCheckbox">I have read and agree to the terms of use.</label>
            </div>
            <div id="checkboxError" class="error-message" style="display: none;">You must agree to the terms to proceed.</div>

            <button type="submit" id="submitButton" disabled>
                Agree & Download APK
                <span class="spinner"></span>
            </button>
        </form>
    </div>

<script>
    const agreeCheckbox = document.getElementById('agreeCheckbox');
    const submitButton = document.getElementById('submitButton');
    const checkboxError = document.getElementById('checkboxError');
    const form = document.getElementById('agreementForm');
    const spinner = submitButton.querySelector('.spinner');

    // Enable button only when checkbox is checked
    agreeCheckbox.addEventListener('change', function() {
        submitButton.disabled = !this.checked;
        checkboxError.style.display = 'none'; // Hide error when checkbox is changed
    });

    form.addEventListener('submit', function(event) {
        // Double-check checkbox on submit
        if (!agreeCheckbox.checked) {
            checkboxError.style.display = 'block';
            event.preventDefault(); // Stop form submission
        } else {
            checkboxError.style.display = 'none';
            // Show spinner and disable button on successful submission attempt
            submitButton.disabled = true;
            spinner.style.display = 'inline-block';
            submitButton.style.opacity = '0.8';
        }
    });
</script>

</body>
</html>